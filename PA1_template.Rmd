---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data


Before we go and download the data, let's first grab the date: `r Sys.Date()`. Next get the data from the web. The file comes from a repository in my GitHub account that was forked from the original.

```{r download}
source_url <- "https://raw.githubusercontent.com/ASonCourse/RepData_PeerAssessment1/master/activity.zip"

download.file(source_url, destfile = "activity.zip", 
              method = "curl")
```

The downloaded file was compressed, so we will unzip it now:

```{r unzip}
unzip("activity.zip", exdir = ".")
```

It turns out the unzipped file is a comma separated file. We can import that into R easily:

```{r import}
activity <- read.csv("activity.csv", stringsAsFactors = FALSE)
```

The `date` variable in `activity` is of type character and needs to be converted to `date`:

```{r char_to_date}
activity$date <- as.Date(activity$date, format = "%Y-%m-%d")
```

This concludes the loading and preprocessing of the data. [Element #1 required for a complete submission ("Code for reading in the dataset and/or processing the data.")]


## What is mean total number of steps taken per day?


Since we'll be using `group_by()` and related commands to figure this out we need to install and load the `dplyr` package:

```{r install_dplyr, message=FALSE, warning=FALSE}
options(repos="https://cran.rstudio.com" )
if (!require(dplyr)) install.packages("dplyr")
library(dplyr)
```

NOTE:

Installing packages by means of R Markdown (`knitr` document) is not advised. The consensus seems to be that users should manage their own package library. We should assume that people know how to install a missing package. Here we've opted to download and install the package _only_ if it's necessary. Arguably a number of users might have dplyr installed / loaded already. See this [resource](https://stackoverflow.com/questions/33969024/install-packages-fails-in-knitr-document-trying-to-use-cran-without-setting-a) for more on the subject.

Calculate mean total number of steps per day:

```{r mean_total_steps}
mean_total_steps <- activity %>%
  group_by(date) %>%
  summarise (daily_steps = sum(steps)) %>%
  summarise(mean_total_steps = mean(daily_steps, na.rm = TRUE))

mean_steps <- round(mean_total_steps, 0)
```

Result: `r as.integer(mean_steps)` steps. How about the median? Let's calculate the median aswell:

```{r median_total_steps}
median_total_steps <- activity %>%
  group_by(date) %>%
  summarise (daily_steps = sum(steps)) %>%
  summarise(mean_total_steps = median(daily_steps, na.rm = TRUE))

median_steps <- round(mean_total_steps, 0)
```

Result: `r as.integer(median_steps)` steps.

So, mean and median are equal! [Element #3 required for a complete submission ("Mean and median number of steps taken each day.")]

How about a plot? Yes, let's create a histogram of the total number of steps taken each day:

```{r histogram_daily_steps}
steps_by_day <- activity %>%
  group_by(date) %>%
  summarise (daily_steps = sum(steps))

hist(steps_by_day$daily_steps,
    main = "Daily Total Steps",
    xlab = "Steps / Day")
```

An alternative way of visualizing the total number of steps taken each day is by means of a boxplot:

```{r boxplot_daily_steps}
boxplot(steps_by_day$daily_steps,
    main = "Daily Total Steps")
```

The histogram shows that on most days the number of steps lies between 10.000 and 15.000. The boxplot clearly shows the mean / median and that there are a couple of outliers. [Element #2 required for a complete submission ("Histogram of the total number of steps taken each day.")]


## What is the average daily activity pattern?


To show the daily activity pattern we have to group and summarise the data by interval first:

```{r steps_by_interval}
steps_by_interval <- activity %>%
  group_by(interval) %>%
  summarise (av_steps = mean(steps, na.rm = TRUE))
```

Once we've done that it's relatively easy to create a time-series plot:

```{r daily_pattern_plot}
plot(steps_by_interval$av_steps, x = steps_by_interval$interval,
     type = "l",
     main = "Daily Activity",
     xlab = "Intervals",
     ylab = "Average Steps")
```

[Element #4 required for a complete submission ("Time series plot of the average number of steps taken.")]

What's the 5-minute interval with the highest number of steps (on average)? Judging from the plot we can guess that it should be around 800. Luckily, we can figure it out exactly:

```{r max_interval}
max_steps <- steps_by_interval[which.max(steps_by_interval$av_steps),]
max_steps_round <- round(max_steps$av_steps, 0)
```

So, the highest number of steps (on average) is `r max_steps_round`. The corresponding interval is `r max_steps$interval`. [Element #5 required for a complete submission ("The 5-minute interval that, on average, contains the maximum number of steps.")]


## Imputing missing values


So, there are missing values in the dataset (NA's). How many of them are there, exactly? Simply calling `summary()` on `activity` will tell us:

```{r total_number_NAs_1}
summary(activity)
```

Alternatively, we can filter out `activity` observations where `steps` is NA and subsequently count the number of rows the filtered dataframe has:

``` {r total_number_NAs_2}
na_activity <- activity %>% filter(is.na(steps) == TRUE)
total_number_NAs <- nrow(na_activity)
```

The result of this operation is: `r total_number_NAs` NA's. In relative terms this represents only a fraction of the original dataset (`r total_number_NAs / nrow(activity)`), though.

How to deal with these NA's?



## Are there differences in activity patterns between weekdays and weekends?
